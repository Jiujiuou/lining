# 按日趋势视图 + Header 交互优化方案

目标：增加「按日期维度的趋势」视图，同时精简顶栏、避免控件过多。下面用 ASCII 给出几种 Header 方案，确认后再改代码。

---

## 一、按日趋势视图（功能约定）

- **含义**：横轴 = **日期**（解析出的所有日期或可选范围），纵轴 = **该指标当日的汇总值**。
- **汇总方式**：建议用「当日 24 点」或「当日有数据的整点的平均值」作为该日的一个点；若某日无该指标数据则该点不画或断线。
- **布局**：仍是 **9 个格子**，每个格子一个指标；每个格子里是 **1 条线**（该指标随日期变化），不是多条线叠在一起。
- **日期范围**：支持「全部日期」或「最近 N 天」（如 7/14），便于长期有数据时先看近期。

---

## 二、当前 Header 问题（ASCII）

```
+------------------------------------------------------------------------------------------------------------------+
|  小贝壳作战 · 数据看板                                                                                             |
|                                                                                                                  |
|  [单日][多日连续][多日自选]  日期[▼]  共[3天▼]  选日期(2天)   [导出PNG]  [更换数据]     ← 控件多、一行挤、多日两种方式并排 |
+------------------------------------------------------------------------------------------------------------------+
```

- 三个 Tab（单日 / 多日连续 / 多日自选）+ 每种对应的参数 + 导出/更换数据，再加「趋势」会更挤。

---

## 三、方案 A：两行 Header（推荐）

**思路**：第一行只放标题 + 全局操作；第二行放「视图切换 + 该视图下的参数」，视图从 3 个改为「单日 / 多日 / 趋势」3 个，多日下的「连续 vs 自选」用**第二行内的小切换**或**下拉**收起来。

```
+------------------------------------------------------------------------------------------------------------------+
|  小贝壳作战 · 数据看板                                                    [ 导出 PNG ]    [ 更换数据 ]             |
+------------------------------------------------------------------------------------------------------------------+
|  [ 单日 ]  [ 多日 ]  [ 趋势 ]        日期 [ 2026-01-29 ▼ ]                                                       |
|     ^ 选中    多日时右侧显示：              单日时：一个日期下拉                                                      |
|                [ 连续 ] 日期 [▼] 共 [3天▼]  或  [ 自选 ] [ 选日期(2天) ▼ ]                                          |
|                趋势时右侧显示：                                                                                    |
|                [ 范围：全部 ▼ ] 或 [ 最近 7 天 ] [ 最近 14 天 ]                                                      |
+------------------------------------------------------------------------------------------------------------------+
```

- **第一行**：标题左对齐；导出、更换数据右对齐，不跟视图参数混在一起。
- **第二行**：3 个主 Tab（单日 / 多日 / 趋势）；右侧仅展示**当前 Tab 需要的参数**，避免一次出现所有控件。
- **多日**：用两个小按钮或 Segmented「连续 | 自选」切换，再显示「日期+共N天」或「选日期」。
- **趋势**：只显示「范围」选择（全部 / 最近7天 / 最近14天），不再选「某一天」。

---

## 四、方案 B：单行 + 视图下拉（收拢视图类型）

**思路**：视图类型收进一个下拉，顶栏只留「视图 [下拉] + 对应参数 + 导出/更换数据」。

```
+------------------------------------------------------------------------------------------------------------------+
|  小贝壳作战 · 数据看板                                                                                             |
|                                                                                                                  |
|    视图 [ 多日连续 ▼ ]    日期 [ 2026-01-29 ▼ ]   共 [ 3 天 ▼ ]              [ 导出 PNG ]  [ 更换数据 ]             |
|         单日                                                                                                     |
|         多日连续  ← 选后显示：日期 + 共N天                                                                         |
|         多日自选  ← 选后显示：选日期(n天)                                                                          |
|         按日趋势  ← 选后显示：范围(全部/最近7天/14天)                                                              |
+------------------------------------------------------------------------------------------------------------------+
```

- 同一行内：视图一个下拉，后面紧跟该视图下的 1～2 个控件，再右侧固定「导出 PNG」「更换数据」。
- 优点：单行、控件少；缺点：视图类型需要多点一次才能看到。

---

## 五、方案 C：单行保留 Tab + 趋势单独成 Tab，多日收成下拉

**思路**：仍用 Tab，但把「多日连续」和「多日自选」合并为一个 Tab「多日」，点「多日」后右侧是一个**下拉**（如「连续 3 天」「连续 7 天」「自选日期」），选「自选」再展开日期多选。

```
+------------------------------------------------------------------------------------------------------------------+
|  小贝壳作战 · 数据看板                                                                                             |
|                                                                                                                  |
|  [ 单日 ]  [ 多日 ]  [ 趋势 ]    日期 [ ▼ ]   多日方式 [ 连续 3 天 ▼ ] 或  [ 选日期(2天) ▼ ]    [ 导出 ]  [ 更换 ]   |
|               多日时：              单日→日期    连续3天/7天/自选                                                      |
|               趋势时：              范围 [ 全部 ▼ ]                                                                  |
+------------------------------------------------------------------------------------------------------------------+
```

- Tab 只有 3 个：单日 / 多日 / 趋势；多日下的「连续 vs 自选」放进一个下拉，减少第二行长度。

---

## 六、方案对比（简要）

| 方案 | 优点 | 缺点 |
|------|------|------|
| A 两行 | 标题与操作分离，视图与参数分区清晰；加趋势后仍可读 | 占两行高度 |
| B 视图下拉 | 单行、最省地方 | 视图类型不一眼可见，需点开 |
| C Tab+多日下拉 | 单行，Tab 保留、多日收拢 | 多日参数仍可能略挤 |

---

## 七、按日趋势视图内容示意（ASCII）

选中「趋势」且范围「全部」时，9 格示意：

```
+------------------+  +------------------+  +------------------+
| 小贝壳-搜索访客数 |  | 小贝壳-搜索转化 % |  | 小贝壳-商品加购   |
|                  |  |                  |  |                  |
|    \    ___/     |  |   ___/  \_       |  |  \___    /       |
|     \__/         |  | _/       \___    |  |      \__/        |
|  1/27 1/28 1/29  |  | 1/27 1/28 1/29   |  | 1/27 1/28 1/29   |
|  横轴=日期       |  | 横轴=日期        |  | 横轴=日期        |
+------------------+  +------------------+  +------------------+
... 共 9 格，每格 1 条线，纵轴=该指标当日汇总值（如 24 点或日均）
```

- 点击格子仍可放大；Tooltip 显示「日期 + 汇总值」；若某日有动作记录，可在 tooltip 中带一句「该日有 N 条动作」或主要动作类型（实现时再定）。

---

## 八、建议

- **优先推荐方案 A（两行 Header）**：加「趋势」后信息量更大，两行能明显减轻单行压力，且「第一行标题+操作 / 第二行视图+参数」符合常见后台/看板习惯。
- 若必须**单行**，再在 B、C 里选（更省空间选 B，更保留 Tab 习惯选 C）。

请确认：  
1）是否采用方案 A，或指定 B/C；  
2）趋势的「汇总方式」是否采用「当日 24 点」或「当日有数据整点的平均值」；  
3）趋势的「范围」是否先做「全部」+「最近 7 天」「最近 14 天」。  

确认后我按选定方案改 Header 并实现按日趋势视图逻辑与数据流。
